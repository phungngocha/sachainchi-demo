<!DOCTYPE html>
<html lang="vi">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Kết quả tìm kiếm</title>
  <style>
  body { font-family: Arial, sans-serif; padding: 20px; background: #f3f4f6; }

  h2 { text-align: center; margin-bottom: 30px; color: #1e293b; }

  #searchResults {
    display: grid;
    grid-template-columns: repeat(auto-fit, minmax(220px, 1fr));
    gap: 20px;
    max-width: 1200px;
    margin: 0 auto;
  }

  .result-item {
    display: flex;
    flex-direction: column;
    background: #fff;
    border-radius: 10px;
    box-shadow: 0 4px 12px rgba(0,0,0,0.1);
    overflow: hidden;
    transition: transform 0.2s ease, box-shadow 0.2s ease;
  }

  .result-item:hover {
    transform: translateY(-4px);
    box-shadow: 0 6px 16px rgba(0,0,0,0.15);
  }

  .result-item img {
    width: 100%;
    height: 180px;
    object-fit: cover;
  }

  .result-item-content {
    padding: 15px;
    display: flex;
    flex-direction: column;
    gap: 8px;
  }

  .result-item h3 {
    margin: 0;
    font-size: 16px;
    color: #1e293b;
  }

  .result-item h3 a {
    color: #0ea5e9;
    text-decoration: none;
    font-weight: 600;
  }

  .result-item p {
    margin: 0;
    font-size: 14px;
    color: #475569;
  }

  .result-item .price {
    font-weight: 700;
    color: #1e40af;
    font-size: 15px;
    margin-top: auto;
  }

  @media (max-width: 500px) {
    .result-item img { height: 140px; }
  }
</style>

</head>
<body>

  <!-- Header và Footer động -->
  <div id="header"></div>

  <h2>Kết quả tìm kiếm</h2>
  <div id="searchResults"></div>

  <div id="footer"></div>

  <!-- import dữ liệu sản phẩm -->
  <script src="products.js"></script>

  <!-- JS load header/footer và tìm kiếm -->
  <script>
    // Hàm load component động
    async function loadComponent(id, file, callback) {
      try {
        const res = await fetch(file);
        if (!res.ok) throw new Error('Fetch failed ' + file + ' : ' + res.status);
        const html = await res.text();
        document.getElementById(id).innerHTML = html;
        if (typeof callback === 'function') callback();
      } catch (err) {
        console.error('loadComponent error:', err);
      }
    }

    // Load header, gắn sự kiện tìm kiếm
    loadComponent("header", "header.html", () => {
      const searchInput = document.getElementById("searchInput");
      if (searchInput) {
        searchInput.addEventListener("keypress", (e) => {
          if (e.key === "Enter") {
            const keyword = searchInput.value.trim();
            if (keyword) {
              window.location.href = `search.html?query=${encodeURIComponent(keyword)}`;
            }
          }
        });
      }
    });

    // Load footer
    loadComponent("footer", "footer.html");

    // === Hiển thị kết quả tìm kiếm ===
    const params = new URLSearchParams(window.location.search);
    const keyword = params.get("query")?.toLowerCase() || "";
    const searchResults = document.getElementById("searchResults");

    if (!keyword) {
      searchResults.innerHTML = "<p style='color:red'>Vui lòng nhập từ khóa tìm kiếm!</p>";
    } else {
      const found = products.filter(p =>
        p.name.toLowerCase().includes(keyword) ||
        p.desc.toLowerCase().includes(keyword)
      );

      if (found.length > 0) {
  found.forEach(p => {
    searchResults.innerHTML += `
      <div class="result-item">
        <img src="${p.img}" alt="${p.name}">
        <div class="result-item-content">
          <h3><a href="product-detail.html?id=${p.id}">${p.name}</a></h3>
          <p>${p.desc}</p>
          <p class="price">${p.prices[0]}</p>
        </div>
      </div>
    `;
  });
} else {
  searchResults.innerHTML = "<p style='color:red; text-align:center'>Không tìm thấy sản phẩm nào!</p>";
}

    }
  </script>

</body>
</html>
